{"version":3,"sources":["../../src/common/chat-server.js"],"names":["chatHandler","socket","on","data","channel","id","oldChannel","console","log","leave","to","emit","join","username","messages","room"],"mappings":";;;;;AAAO,MAAMA,oCAAcC,UAAU;;AAEnCA,SAAOC,EAAP,CAAU,MAAV,EAAmBC,IAAD,IAAU;AAC1B,UAAM,EAACC,OAAD,EAAUC,EAAV,KAAgBF,IAAtB;AACA,UAAMG,aAAaL,OAAOG,OAA1B;AACA,QAAGE,UAAH,EAAc;AACZC,cAAQC,GAAR,CAAa,QAAOH,EAAG,UAASD,OAAQ,EAAxC;AACAH,aAAOQ,KAAP,CAAaH,UAAb;AACAL,aAAOS,EAAP,CAAUN,OAAV,EAAmBO,IAAnB,CAAwB,WAAxB,EAAsC,aAAYN,EAAG,GAArD;AACD;AACDJ,WAAOG,OAAP,GAAiBA,OAAjB;AACAG,YAAQC,GAAR,CAAa,QAAOH,EAAG,YAAWD,OAAQ,EAA1C;AACAH,WAAOW,IAAP,CAAYR,OAAZ;AACAH,WAAOS,EAAP,CAAUN,OAAV,EAAmBO,IAAnB,CAAwB,WAAxB,EAAsC,aAAYN,EAAG,GAArD;AACD,GAZD;;AAcAJ,SAAOC,EAAP,CAAU,MAAV,EAAmBC,IAAD,IAAU;AAC1B,UAAMC,UAAUH,OAAOG,OAAvB;AACA,UAAM,EAAES,QAAF,EAAYC,QAAZ,KAAyBX,IAA/B;AACAF,WAAOS,EAAP,CAAUN,OAAV,EAAmBO,IAAnB,CAAwB,MAAxB,EAAgC,EAAEE,QAAF,EAAYE,MAAMX,OAAlB,EAA2BU,QAA3B,EAAhC;AACD,GAJD;AAKD,CArBM","file":"chat-server.js","sourcesContent":["export const chatHandler = socket => {\n\n  socket.on('join', (data) => {\n    const {channel, id} = data;\n    const oldChannel = socket.channel;\n    if(oldChannel){\n      console.log(`user:${id} left: ${channel}`);\n      socket.leave(oldChannel);\n      socket.to(channel).emit('broadcast', `left chat ${id} `);\n    }\n    socket.channel = channel;\n    console.log(`user:${id} joined: ${channel}`);\n    socket.join(channel);\n    socket.to(channel).emit('broadcast', `Join chat ${id} `);\n  });\n\n  socket.on('chat', (data) => {\n    const channel = socket.channel;\n    const { username, messages } = data;\n    socket.to(channel).emit('chat', { username, room: channel, messages});\n  });\n};\n"]}